"use strict";(()=>{var e={};e.id=15,e.ids=[15],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},5477:e=>{e.exports=require("punycode")},2781:e=>{e.exports=require("stream")},7310:e=>{e.exports=require("url")},9796:e=>{e.exports=require("zlib")},8693:(e,r,i)=>{i.r(r),i.d(r,{headerHooks:()=>_,originalPathname:()=>f,patchFetch:()=>x,requestAsyncStorage:()=>h,routeModule:()=>g,serverHooks:()=>z,staticGenerationAsyncStorage:()=>I,staticGenerationBailout:()=>b});var t={};i.r(t),i.d(t,{POST:()=>m});var o=i(5419),a=i(9108),n=i(9678),s=i(8070),u=i(2964);let d="https://zkydbbarowexcqhsurky.supabase.co",c="your_supaba=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpreWRiYmFyb3dleGNxaHN1cmt5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4MjQwMTksImV4cCI6MjA3NDQwMDAxOX0.k9PDWkCirDd-9_C7KamuWOULqcuMjw1KuZz5wx95EPs",p=null,l=(0,u.eI)(d,c,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}});async function m(e){try{let{userId:r}=await e.json();if(!r)return s.Z.json({error:"User ID is required"},{status:400});let{data:i}=await l.from("org_members").select("org_id, organizations(*)").eq("user_id",r).eq("role","owner").single();if(i)return s.Z.json({message:"Admin already has an organization",organization:i.organizations});let{data:t,error:o}=await l.from("organizations").insert({name:"Timeline Alchemy Admin",plan:"enterprise"}).select().single();if(o||!t)return console.error("Error creating admin organization:",o),s.Z.json({error:"Failed to create organization"},{status:500});let{error:a}=await l.from("org_members").insert({org_id:t.id,user_id:r,role:"owner"});if(a)return console.error("Error adding admin to organization:",a),s.Z.json({error:"Failed to add admin to organization"},{status:500});let{error:n}=await l.from("subscriptions").insert({org_id:t.id,stripe_customer_id:"admin-"+t.id,stripe_subscription_id:"admin-sub-"+t.id,plan:"enterprise",status:"active"});return n&&console.error("Error creating admin subscription:",n),s.Z.json({message:"Admin organization created successfully",organization:t})}catch(e){return console.error("Error creating admin organization:",e),s.Z.json({error:"Internal server error"},{status:500})}}(0,u.eI)(d,process.env.SUPABASE_SERVICE_ROLE_KEY||c,{auth:{autoRefreshToken:!1,persistSession:!1}});let g=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/create-admin-org/route",pathname:"/api/create-admin-org",filename:"route",bundlePath:"app/api/create-admin-org/route"},resolvedPagePath:"C:\\Users\\denni\\Desktop\\Chosen Ones Toolkit\\Chosen Ones Community\\Portal Coding\\AI-Timeline-Alchemy\\golden-image-creator\\app\\api\\create-admin-org\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:h,staticGenerationAsyncStorage:I,serverHooks:z,headerHooks:_,staticGenerationBailout:b}=g,f="/api/create-admin-org/route";function x(){return(0,n.patchFetch)({serverHooks:z,staticGenerationAsyncStorage:I})}}};var r=require("../../../webpack-runtime.js");r.C(e);var i=e=>r(r.s=e),t=r.X(0,[638,206,122,964],()=>i(8693));module.exports=t})();