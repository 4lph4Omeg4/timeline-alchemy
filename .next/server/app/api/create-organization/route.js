"use strict";(()=>{var e={};e.id=336,e.ids=[336],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},5477:e=>{e.exports=require("punycode")},2781:e=>{e.exports=require("stream")},7310:e=>{e.exports=require("url")},9796:e=>{e.exports=require("zlib")},5116:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>m,originalPathname:()=>z,patchFetch:()=>I,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>g,staticGenerationAsyncStorage:()=>l,staticGenerationBailout:()=>h});var o={};t.r(o),t.d(o,{POST:()=>c});var i=t(5419),a=t(9108),s=t(9678),n=t(8070),u=t(8234);async function c(e){try{let{userId:r,userName:t}=await e.json();if(!r||!t)return n.Z.json({error:"Missing required fields"},{status:400});let{data:o}=await u.O.from("org_members").select("org_id, organizations(*)").eq("user_id",r).eq("role","owner").single();if(o)return n.Z.json({message:"User already has an organization",organization:o.organizations});let{data:i,error:a}=await u.O.from("organizations").insert({name:`${t}'s Organization`,plan:"basic"}).select().single();if(a||!i)return console.error("Error creating organization:",a),n.Z.json({error:"Failed to create organization"},{status:500});let{error:s}=await u.O.from("org_members").insert({org_id:i.id,user_id:r,role:"owner"});if(s)return console.error("Error adding user to organization:",s),n.Z.json({error:"Failed to add user to organization"},{status:500});let{error:c}=await u.O.from("subscriptions").insert({org_id:i.id,stripe_customer_id:"temp-"+i.id,stripe_subscription_id:"temp-sub-"+i.id,plan:"basic",status:"active"});return c&&console.error("Error creating subscription:",c),n.Z.json({message:"Organization created successfully",organization:i})}catch(e){return console.error("Create Organization API Error:",e),n.Z.json({error:"Internal server error"},{status:500})}}let p=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/create-organization/route",pathname:"/api/create-organization",filename:"route",bundlePath:"app/api/create-organization/route"},resolvedPagePath:"C:\\Users\\denni\\Desktop\\Chosen Ones Toolkit\\Chosen Ones Community\\Portal Coding\\AI-Timeline-Alchemy\\golden-image-creator\\app\\api\\create-organization\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:l,serverHooks:g,headerHooks:m,staticGenerationBailout:h}=p,z="/api/create-organization/route";function I(){return(0,s.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:l})}},8234:(e,r,t)=>{t.d(r,{O:()=>n});var o=t(2964);let i="https://zkydbbarowexcqhsurky.supabase.co",a="your_supaba=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpreWRiYmFyb3dleGNxaHN1cmt5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4MjQwMTksImV4cCI6MjA3NDQwMDAxOX0.k9PDWkCirDd-9_C7KamuWOULqcuMjw1KuZz5wx95EPs",s=null,n=(0,o.eI)(i,a,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}});(0,o.eI)(i,process.env.SUPABASE_SERVICE_ROLE_KEY||a,{auth:{autoRefreshToken:!1,persistSession:!1}})}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[638,206,122,964],()=>t(5116));module.exports=o})();